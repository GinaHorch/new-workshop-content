---
title: "PDF Certificate - JavaScript"
weight: 12
chapter: false
---

Get your Certificate!


<style>@import url(https://fonts.bunny.net/css?family=raleway:400,700);</style>
<style>
#_form_39_{font-size:14px;line-height:1.6;font-family:arial, helvetica, sans-serif;margin:0}#_form_39_ *{outline:0}._form_hide{display:none;visibility:hidden}._form_show{display:block;visibility:visible}#_form_39_._form-top{top:0}#_form_39_._form-bottom{bottom:0}#_form_39_._form-left{left:0}#_form_39_._form-right{right:0}#_form_39_ input[type="text"],#_form_39_ input[type="tel"],#_form_39_ input[type="date"],#_form_39_ textarea{padding:6px;height:auto;border:#979797 1px solid;border-radius:4px;color:#000000 !important;font-size:14px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#_form_39_ textarea{resize:none}#_form_39_ ._submit{-webkit-appearance:none;cursor:pointer;font-family:arial, sans-serif;font-size:14px;text-align:center;background:#8246AF !important;border:0 !important;-moz-border-radius:4px !important;-webkit-border-radius:4px !important;border-radius:4px !important;color:#FFFFFF !important;padding:10px !important}#_form_39_ ._submit:disabled{cursor:not-allowed;opacity:0.4}#_form_39_ ._submit.processing{position:relative}#_form_39_ ._submit.processing::before{content:"";width:1em;height:1em;position:absolute;z-index:1;top:50%;left:50%;border:double 3px transparent;border-radius:50%;background-image:linear-gradient(#8246AF, #8246AF), conic-gradient(#8246AF, #FFFFFF);background-origin:border-box;background-clip:content-box, border-box;animation:1200ms ease 0s infinite normal none running _spin}#_form_39_ ._submit.processing::after{content:"";position:absolute;top:0;bottom:0;left:0;right:0;background:#8246AF !important;border:0 !important;-moz-border-radius:4px !important;-webkit-border-radius:4px !important;border-radius:4px !important;color:#FFFFFF !important;padding:10px !important}@keyframes _spin{0%{transform:translate(-50%, -50%) rotate(90deg)}100%{transform:translate(-50%, -50%) rotate(450deg)}}#_form_39_ ._close-icon{cursor:pointer;background-image:url("https://d226aj4ao1t61q.cloudfront.net/esfkyjh1u_forms-close-dark.png");background-repeat:no-repeat;background-size:14.2px 14.2px;position:absolute;display:block;top:11px;right:9px;overflow:hidden;width:16.2px;height:16.2px}#_form_39_ ._close-icon:before{position:relative}#_form_39_ ._form-body{margin-bottom:30px}#_form_39_ ._form-image-left{width:150px;float:left}#_form_39_ ._form-content-right{margin-left:164px}#_form_39_ ._form-branding{color:#fff;font-size:10px;clear:both;text-align:left;margin-top:30px;font-weight:100}#_form_39_ ._form-branding ._logo{display:block;width:130px;height:14px;margin-top:6px;background-image:url("https://d226aj4ao1t61q.cloudfront.net/hh9ujqgv5_aclogo_li.png");background-size:130px auto;background-repeat:no-repeat}#_form_39_ .form-sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}#_form_39_ ._form-label,#_form_39_ ._form_element ._form-label{font-weight:bold;margin-bottom:5px;display:block}#_form_39_._dark ._form-branding{color:#333}#_form_39_._dark ._form-branding ._logo{background-image:url("https://d226aj4ao1t61q.cloudfront.net/jftq2c8s_aclogo_dk.png")}#_form_39_ ._form_element{position:relative;margin-bottom:10px;font-size:0;max-width:100%}#_form_39_ ._form_element *{font-size:14px}#_form_39_ ._form_element._clear{clear:both;width:100%;float:none}#_form_39_ ._form_element._clear:after{clear:left}#_form_39_ ._form_element input[type="text"],#_form_39_ ._form_element input[type="date"],#_form_39_ ._form_element select,#_form_39_ ._form_element textarea:not(.g-recaptcha-response){display:block;width:100%;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-family:inherit}#_form_39_ ._field-wrapper{position:relative}#_form_39_ ._inline-style{float:left}#_form_39_ ._inline-style input[type="text"]{width:150px}#_form_39_ ._inline-style:not(._clear)+._inline-style:not(._clear){margin-left:20px}#_form_39_ ._form_element img._form-image{max-width:100%}#_form_39_ ._form_element ._form-fieldset{border:0;padding:0.01em 0 0 0;margin:0;min-width:0}#_form_39_ ._clear-element{clear:left}#_form_39_ ._full_width{width:100%}#_form_39_ ._form_full_field{display:block;width:100%;margin-bottom:10px}#_form_39_ input[type="text"]._has_error,#_form_39_ textarea._has_error{border:#F37C7B 1px solid}#_form_39_ input[type="checkbox"]._has_error{outline:#F37C7B 1px solid}#_form_39_ ._error{display:block;position:absolute;font-size:14px;z-index:10000001}#_form_39_ ._error._above{padding-bottom:4px;bottom:39px;right:0}#_form_39_ ._error._below{padding-top:8px;top:100%;right:0}#_form_39_ ._error._above ._error-arrow{bottom:-4px;right:15px;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #FFDDDD}#_form_39_ ._error._below ._error-arrow{top:0;right:15px;border-left:8px solid transparent;border-right:8px solid transparent;border-bottom:8px solid #FFDDDD}#_form_39_ ._error-inner{padding:12px 12px 12px 36px;background-color:#FFDDDD;background-image:url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM9 3V9H7V3H9ZM9 13V11H7V13H9Z' fill='%23CA0000'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:12px center;font-size:14px;font-family:arial, sans-serif;font-weight:600;line-height:16px;color:#000;text-align:center;text-decoration:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;box-shadow:0px 1px 4px rgba(31, 33, 41, 0.298295)}#_form_39_ ._error-inner._form_error{margin-bottom:5px;text-align:left}#_form_39_ ._button-wrapper ._error-inner._form_error{position:static}#_form_39_ ._error-inner._no_arrow{margin-bottom:10px}#_form_39_ ._error-arrow{position:absolute;width:0;height:0}#_form_39_ ._error-html{margin-bottom:10px}.pika-single{z-index:10000001 !important}#_form_39_ input[type="text"].datetime_date{width:69%;display:inline}#_form_39_ select.datetime_time{width:29%;display:inline;height:32px}#_form_39_ input[type="date"].datetime_date{width:69%;display:inline-flex}#_form_39_ input[type="time"].datetime_time{width:29%;display:inline-flex}@media (min-width:320px) and (max-width:667px){::-webkit-scrollbar{display:none}#_form_39_{margin:0;width:100%;min-width:100%;max-width:100%;box-sizing:border-box}#_form_39_ *{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-size:1em}#_form_39_ ._form-content{margin:0;width:100%}#_form_39_ ._form-inner{display:block;min-width:100%}#_form_39_ ._form-title,#_form_39_ ._inline-style{margin-top:0;margin-right:0;margin-left:0}#_form_39_ ._form-title{font-size:1.2em}#_form_39_ ._form_element{margin:0 0 20px;padding:0;width:100%}#_form_39_ ._form-element,#_form_39_ ._inline-style,#_form_39_ input[type="text"],#_form_39_ label,#_form_39_ p,#_form_39_ textarea:not(.g-recaptcha-response){float:none;display:block;width:100%}#_form_39_ ._row._checkbox-radio label{display:inline}#_form_39_ ._row,#_form_39_ p,#_form_39_ label{margin-bottom:0.7em;width:100%}#_form_39_ ._row input[type="checkbox"],#_form_39_ ._row input[type="radio"]{margin:0 !important;vertical-align:middle !important}#_form_39_ ._row input[type="checkbox"]+span label{display:inline}#_form_39_ ._row span label{margin:0 !important;width:initial !important;vertical-align:middle !important}#_form_39_ ._form-image{max-width:100%;height:auto !important}#_form_39_ input[type="text"]{padding-left:10px;padding-right:10px;font-size:16px;line-height:1.3em;-webkit-appearance:none}#_form_39_ input[type="radio"],#_form_39_ input[type="checkbox"]{display:inline-block;width:1.3em;height:1.3em;font-size:1em;margin:0 0.3em 0 0;vertical-align:baseline}#_form_39_ button[type="submit"]{padding:20px;font-size:1.5em}#_form_39_ ._inline-style{margin:20px 0 0 !important}}#_form_39_{position:relative;text-align:left;margin:25px auto 0;padding-top:20px;padding-right:20px;padding-bottom:20px;padding-left:20px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;background:rgba(255, 255, 255, 0) !important;border-top:2px solid #050505 !important;border-right:2px solid #050505 !important;border-bottom:2px solid #050505 !important;border-left:2px solid #050505 !important;-moz-border-radius:24px !important;-webkit-border-radius:24px !important;border-radius:24px !important;color:#000000}#_form_39_._inline-form,#_form_39_._inline-form ._form-content{font-family:Raleway;font-size:14px;font-weight:400}#_form_39_._inline-form ._row span,#_form_39_._inline-form ._row label{font-family:Raleway;font-size:14px;font-weight:400;line-height:1.6em;color:black !important}#_form_39__inlineform input[type="text"],#_form_39__inlineform input[type="date"],#_form_39__inlineform input[type="tel"],#_form_39__inlineform select,#_form_39__inlineform textarea:not(.g-recaptcha-response){font-family:Raleway;font-size:14px;font-weight:400;font-color:#000000;line-height:1.6em}#_form_39_._inline-form ._html-code *,#_form_39_._inline-form ._form-thank-you{font-family:Raleway;font-size:14px;font-weight:400;color:black !important}#_form_39_._inline-form ._form-label,#_form_39_._inline-form ._form-checkbox-option-label,#_form_39_._inline-form ._form-checkbox-option-description{font-family:Raleway;font-size:14px;font-weight:700;line-height:1.6em;color:black !important}#_form_39_._inline-form ._submit{font-family:Raleway;font-size:14px;font-weight:400}#_form_39_._inline-form ._form-title{font-family:Raleway;font-size:22px;line-height:normal;font-weight:700;color:black;margin-bottom:0}#_form_39_._inline-form ._form-branding{font-family:"IBM Plex Sans", Helvetica, sans-serif;font-size:13px;font-weight:100;font-style:normal;text-decoration:none}#_form_39_:before,#_form_39_:after{content:" ";display:table}#_form_39_:after{clear:both}#_form_39_._inline-style{width:auto;display:inline-block}#_form_39_._inline-style input[type="text"],#_form_39_._inline-style input[type="date"]{padding:10px 12px}#_form_39_._inline-style button._inline-style{position:relative;top:27px}#_form_39_._inline-style p{margin:0}#_form_39_._inline-style ._button-wrapper{position:relative;margin:27px 12.5px 0 20px}#_form_39_ ._form-thank-you{position:relative;left:0;right:0;text-align:center;font-size:18px}@media (min-width:320px) and (max-width:667px){#_form_39_._inline-form._inline-style ._inline-style._button-wrapper{margin-top:20px !important;margin-left:0 !important}}#_form_39_ .iti.iti--allow-dropdown.iti--separate-dial-code{width:100%}#_form_39_ .iti input{width:100%;height:32px;border:#979797 1px solid;border-radius:4px}#_form_39_ .iti--separate-dial-code .iti__selected-flag{background-color:#FFFFFF;border-radius:4px}#_form_39_ .iti--separate-dial-code .iti__selected-flag:hover{background-color:rgba(0, 0, 0, 0.05)}#_form_39_ .iti__country-list{border-radius:4px;margin-top:4px;min-width:460px}#_form_39_ .iti__country-list--dropup{margin-bottom:4px}#_form_39_ .phone-error-hidden{display:none}#_form_39_ .phone-error{color:#E40E49}#_form_39_ .phone-input-error{border:1px solid #E40E49 !important}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field fieldset{margin:0;margin-bottom:1.1428571429em;border:none;padding:0}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field fieldset:last-child{margin-bottom:0}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field legend{margin-bottom:1.1428571429em}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field label{display:flex;align-items:flex-start;justify-content:flex-start;margin-bottom:0.8571428571em}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field label:last-child{margin-bottom:0}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field input{margin:0;margin-right:8px}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field ._form-checkbox-option-label{line-height:1;display:block;font-weight:700}#_form_39_._inline-form ._form-content ._form-list-subscriptions-field ._form-checkbox-option-description{margin:0;margin-top:0.3333333333em;font-size:0.8571428571em}</style>


<div style="text-align: center;">
  <form method="POST" action="https://shecodes.activehosted.com/proc.php" id="_form_39_" class="_form _form_39 _inline-form _inline-style _dark" novalidate data-styles-version="5">
    <input type="hidden" name="u" value="39" />
    <input type="hidden" name="f" value="39" />
    <input type="hidden" name="s" />
    <input type="hidden" name="c" value="0" />
    <input type="hidden" name="m" value="0" />
    <input type="hidden" name="act" value="sub" />
    <input type="hidden" name="v" value="2" />
    <input type="hidden" name="or" value="8477a0cecf939eafb8e8f74791ed2d43" />
    <input type="hidden" name="tags" value="Completed Tutorial - JavaScript" />
    <div class="_form-content">
      <div class="_form_element _x99529096 _inline-style _clear" >
        <div class="_form-title">
          Download your Certificate of Completion!
        </div>
      </div>
      <div class="_form_element _x34324125 _inline-style _clear" >
        <div class="_html-code">
          <p>
            Add your details and you will be able to instantly download your JavaScript certificate.
          </p>
        </div>
      </div>
      <div class="_form_element _x38717875 _inline-style " >
        <label for="firstname" class="_form-label">
          First Name
        </label>
        <div class="_field-wrapper">
          <input type="text" id="firstname" name="firstname" placeholder="Type your first name" />
        </div>
      </div>
      <div class="_form_element _x35868038 _inline-style " >
        <label for="lastname" class="_form-label">
          Last Name
        </label>
        <div class="_field-wrapper">
          <input type="text" id="lastname" name="lastname" placeholder="Type your last name" />
        </div>
      </div>
      <div class="_form_element _x44330160 _inline-style " >
        <label for="email" class="_form-label">
          Email*
        </label>
        <div class="_field-wrapper">
          <input type="text" id="email" name="email" placeholder="Type your email" required/>
        </div>
      </div>
      <div class="_button-wrapper _inline-style">
        <input id="_form_39_submit" class="_submit" type="submit"  value="Download" >
        </input>
      </div>
      <div class="_clear-element">
      </div>
    </div>
    <div class="_form-thank-you" style="display:none;">
    </div>
  </form>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>

<script>
// Function to generate PDF certificate
function generateCertificate() {
    const firstName = document.getElementById('firstname').value;
    const lastName = document.getElementById('lastname').value;
    
    if (!firstName || !lastName) {
        alert('Please enter both first and last name to generate certificate');
        return;
    }
    
    const doc = new jsPDF({
        orientation: "landscape",
        unit: "mm",
        format: "a4"
    });
    const image = new Image();
    image.src = "./JavaScript_Certificate.png";
    
    image.onload = function() {
        doc.addImage(image, "png", 0, 0, 297, 210);
        doc.setFontSize(22);
        doc.text(`${firstName} ${lastName}`, 150, 80, 'center');
        doc.save("She Codes Australia JavaScript Certificate");
    };
    
    // Fallback if image doesn't load
    image.onerror = function() {
        doc.setFontSize(22);
        doc.text(`${firstName} ${lastName}`, 150, 80, 'center');
        doc.text('JavaScript Certificate', 150, 100, 'center');
        doc.save("She Codes Australia JavaScript Certificate");
    };
}

// Method 1: ActiveCampaign success callback (for form submission)
window._form_callback = function(id) {
    if (id === 39) {
        generateCertificate();
    }
};

// Method 2: Direct button click (fallback/immediate generation)
document.addEventListener('DOMContentLoaded', function() {
    // URL parameter pre-filling for email links
    const urlParams = new URLSearchParams(window.location.search);
    const firstName = urlParams.get('firstname');
    const lastName = urlParams.get('lastname');
    
    if (firstName) {
        document.getElementById('firstname').value = decodeURIComponent(firstName);
    }
    if (lastName) {
        document.getElementById('lastname').value = decodeURIComponent(lastName);
    }
    
    // AUTO-DOWNLOAD: If both names are provided via URL, generate certificate automatically
    if (firstName && lastName) {
        // Small delay to ensure page loads completely
        setTimeout(function() {
            generateCertificate();
            // Hide the form and show a success message
            document.querySelector('._form-content').style.display = 'none';
            document.querySelector('._form-thank-you').innerHTML = 
                '<h3>Your certificate is downloading!</h3><p>Your personalised JavaScript certificate should appear in your downloads folder.</p><br><button onclick="generateCertificate()" style="background:#8246AF; color:white; padding:10px 20px; border:none; border-radius:4px; cursor:pointer;">Download Again</button>';
            document.querySelector('._form-thank-you').style.display = 'block';
        }, 500);
    }
    
    // Add click listener for manual PDF generation when form is visible
    const submitBtn = document.getElementById('_form_39_submit');
    if (submitBtn) {
        submitBtn.addEventListener('click', function(e) {
            // Generate PDF immediately
            generateCertificate();
        });
    }
});
</script>


<script>
window.cfields = [];
window._show_thank_you = function(id, message, trackcmp_url, email) {
    var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
    form.querySelector('._form-content').style.display = 'none';
    thank_you.innerHTML = message;
    thank_you.style.display = 'block';
    const vgoAlias = typeof visitorGlobalObjectAlias === 'undefined' ? 'vgo' : visitorGlobalObjectAlias;
    var visitorObject = window[vgoAlias];
    if (email && typeof visitorObject !== 'undefined') {
        visitorObject('setEmail', email);
        visitorObject('update');
    } else if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
        // Site tracking URL to use after inline form submission.
        _load_script(trackcmp_url);
    }
    if (typeof window._form_callback !== 'undefined') window._form_callback(id);
};
window._show_unsubscribe = function(id, message, trackcmp_url, email) {
    var form = document.getElementById('_form_' + id + '_'), unsub = form.querySelector('._form-thank-you');
    var branding = form.querySelector('._form-branding');
    if (branding) {
        branding.style.display = 'none';
    }
    form.querySelector('._form-content').style.display = 'none';
    unsub.style.display = 'block';
    form.insertAdjacentHTML('afterend', message)
    const vgoAlias = typeof visitorGlobalObjectAlias === 'undefined' ? 'vgo' : visitorGlobalObjectAlias;
    var visitorObject = window[vgoAlias];
    if (email && typeof visitorObject !== 'undefined') {
        visitorObject('setEmail', email);
        visitorObject('update');
    } else if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
        // Site tracking URL to use after inline form submission.
        _load_script(trackcmp_url);
    }
    if (typeof window._form_callback !== 'undefined') window._form_callback(id);
};
window._load_script = function(url, callback, isSubmit) {
    var head = document.getElementsByTagName('head')[0], done = false, script = document.createElement('script');
    script.type = 'text/javascript';
    script.charset = 'utf-8';
    script.src = url;
    if (typeof callback === 'function') {
        script.onreadystatechange = script.onload = function() {
            if (!done && (!this.readyState || this.readyState === 'loaded' || this.readyState === 'complete')) {
                done = true;
                script.onreadystatechange = script.onload = null;
                callback();
            }
        };
    }
    head.appendChild(script);
};
window._form_serialize = function(form) {
    if(!form || form.nodeName !== "FORM"){
        return;
    }
    var i, j, q = [];
    for(i = 0; i < form.elements.length; i++){
        if(form.elements[i].name === ""){
            continue;
        }
        switch(form.elements[i].nodeName){
            case 'INPUT':
                switch(form.elements[i].type){
                    case 'text':
                    case 'hidden':
                    case 'password':
                    case 'button':
                    case 'reset':
                    case 'submit':
                        q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                        break;
                    case 'checkbox':
                    case 'radio':
                        if(form.elements[i].checked){
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                        }
                        break;
                    case 'file':
                        break;
                }
                break;
            case 'TEXTAREA':
                q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                break;
            case 'SELECT':
                switch(form.elements[i].type){
                    case 'select-one':
                        q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                        break;
                    case 'select-multiple':
                        for(j = 0; j < form.elements[i].options.length; j++){
                            if(form.elements[i].options[j].selected){
                                q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].options[j].value));
                            }
                        }
                        break;
                }
                break;
        }
    }
    return q.join("&");
};

var form_to_submit = document.getElementById('_form_39_');
var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

var getUrlParam = function(name) {
    if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
        return decodeURIComponent(name[1]);
};

for (var i = 0; i < allInputs.length; i++) {
    var regexStr = "field\\[(\\d+)\\]";
    var results = new RegExp(regexStr).exec(allInputs[i].name);
    if (results != undefined) {
        allInputs[i].dataset.name = window.cfields[results[1]];
    } else {
        allInputs[i].dataset.name = allInputs[i].name;
    }
    var fieldVal = getUrlParam(allInputs[i].dataset.name);

    if (fieldVal) {
        if (allInputs[i].dataset.autofill === "false") {
            continue;
        }
        if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
            if (allInputs[i].value == fieldVal) {
                allInputs[i].checked = true;
            }
        } else {
            allInputs[i].value = fieldVal;
        }
    }
}

var remove_tooltips = function() {
    for (var i = 0; i < tooltips.length; i++) {
        tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
    }
    tooltips = [];
};
var remove_tooltip = function(elem) {
    for (var i = 0; i < tooltips.length; i++) {
        if (tooltips[i].elem === elem) {
            tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
            tooltips.splice(i, 1);
            return;
        }
    }
};
var create_tooltip = function(elem, text) {
    var tooltip = document.createElement('div'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
    if (elem.type != 'radio' && elem.type != 'checkbox') {
        tooltip.className = '_error';
        arrow.className = '_error-arrow';
        inner.className = '_error-inner';
        inner.innerHTML = text;
        tooltip.appendChild(arrow);
        tooltip.appendChild(inner);
        elem.parentNode.appendChild(tooltip);
    } else {
        tooltip.className = '_error-inner _no_arrow';
        tooltip.innerHTML = text;
        elem.parentNode.insertBefore(tooltip, elem);
        new_tooltip.no_arrow = true;
    }
    new_tooltip.tip = tooltip;
    new_tooltip.elem = elem;
    tooltips.push(new_tooltip);
    return new_tooltip;
};
var resize_tooltip = function(tooltip) {
    var rect = tooltip.elem.getBoundingClientRect();
    var doc = document.documentElement, scrollLeft = window.pageXOffset || doc.scrollLeft, scrollTop = window.pageYOffset || doc.scrollTop;
    var tooltip_rect = tooltip.tip.getBoundingClientRect();
    var center = (rect.left + rect.right) / 2 - scrollLeft;
    tooltip.tip.style.left = Math.min(Math.max(center - tooltip_rect.width / 2, 5), window.innerWidth - tooltip_rect.width - 5) + 'px';
    if (center < tooltip_rect.width / 2) {
        tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/, '') + ' _above';
    } else {
        tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/, '') + ' _below';
    }
};
var validate_form = function(e) {
    var err = form_to_submit.querySelector('._form_error'), no_error = true;
    if (!submitted) {
        submitted = true;
        for (var i = 0, len = allInputs.length; i < len; i++) {
            var input = allInputs[i];
            if (input.type == 'text') {
                input.value = input.value.trim();
                var lower = input.value.toLowerCase();
                if (input.name == 'email' && lower !== input.value) {
                    input.value = lower;
                }
            }
        }
        if (err) {
            no_error = false;
            err.parentNode.removeChild(err);
        }
        _load_script("//d226aj4ao1t61q.cloudfront.net/wpc6Conversions.js", function() {
            if (wpc) {
                wpc.init('form', '#_form_39_', 'f1665dc7e', true);
                wpc.track();
            }
        });
        if (!no_error && e) {
            e.preventDefault();
        }
        resize_tooltips();
        return no_error;
    }
    if (e) {
        e.preventDefault();
    }
    return false;
};
addEvent(window, 'resize', resize_tooltips);
var resize_tooltips = function() {
    for (var i = 0; i < tooltips.length; i++) {
        resize_tooltip(tooltips[i]);
    }
};
var validate_field = function(elem, remove) {
    var tooltip = null, value = elem.value, no_error = true;
    remove = remove || false;
    if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
    if (elem.getAttribute('required') !== null) {
        if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
            var elems = form_to_submit.elements[elem.name];
            if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
                no_error = false;
                elem.className = elem.className + ' _has_error';
                create_tooltip(elem, "Please select an option.");
                return no_error;
            }
            for (var i = 0; i < elems.length; i++) {
                if (elems[i].getAttribute('required') === null) continue;
                if (elems[i].checked) {
                    no_error = true;
                    break;
                }
                no_error = false;
                elems[i].className = elems[i].className + ' _has_error';
            }
            if (!no_error) {
                create_tooltip(elem, "Please select an option.");
            }
        } else if (elem.type =='checkbox') {
            var elems = form_to_submit.elements[elem.name], found = false, err = [];
            no_error = true;
            for (var i = 0; i < elems.length; i++) {
                if (elems[i].getAttribute('required') === null) continue;
                if (elems[i].checked) found = true;
            }
            if (!found) {
                no_error = false;
                for (var i = 0; i < elems.length; i++) {
                    if (elems[i].getAttribute('required') === null) continue;
                    elems[i].className = elems[i].className + ' _has_error';
                    err.push("Checking %s is required".replace("%s", elems[i].value));
                }
                if (err.length == 1) {
                    create_tooltip(elem, err[0]);
                } else {
                    create_tooltip(elem, err.join('<br/>'));
                }
            }
        } else if (elem.tagName == 'SELECT') {
            var selected = true;
            if (elem.multiple) {
                selected = false;
                for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected) {
                        selected = true;
                        break;
                    }
                }
            } else {
                for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected && (!elem.options[i].value || (elem.options[i].value.match(/\n/g)))) {
                        selected = false;
                    }
                }
            }
            if (!selected) {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                create_tooltip(elem, "Please select an option.");
            }
        } else if (value === undefined || value === null || value === '') {
            elem.className = elem.className + ' _has_error';
            no_error = false;
            create_tooltip(elem, "This field is required.");
        }
    }
    if (no_error && elem.name == 'email') {
        if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
            elem.className = elem.className + ' _has_error';
            no_error = false;
            create_tooltip(elem, "Enter a valid email address.");
        }
    }
    if (no_error && /date_field/.test(elem.className)) {
        if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
            elem.className = elem.className + ' _has_error';
            no_error = false;
            create_tooltip(elem, "Enter a valid date.");
        }
    }
    tooltip ? resize_tooltip(tooltip) : false;
    if (remove) {
        remove_tooltip(elem);
    }
    return no_error;
};
var needs_validate = function(el) {
    if(el.getAttribute('required') !== null){
        return true
    }
    if(el.name === 'email' && el.value !== ""){
        return true
    }
    return false
};
var validate_form = function(e) {
    var err = form_to_submit.querySelector('._form_error'), no_error = true;
    if (!submitted) {
        submitted = true;
        for (var i = 0, len = allInputs.length; i < len; i++) {
            var input = allInputs[i];
            if (needs_validate(input)) {
                if (input.type == 'text') {
                    input.value = input.value.trim();
                    var lower = input.value.toLowerCase();
                    if (input.name == 'email' && lower !== input.value) {
                        input.value = lower;
                    }
                }
                if (!validate_field(input, true)) {
                    no_error = false;
                }
            }
        }
        if (!no_error && e) {
            e.preventDefault();
        }
        resize_tooltips();
        return no_error;
    }
    if (e) {
        e.preventDefault();
    }
    return false;
};
var addEvent = function(element, event, func) {
    if (element.addEventListener) {
        element.addEventListener(event, func);
    } else {
        var oldFunc = element['on' + event];
        element['on' + event] = function() {
            oldFunc.apply(element, arguments);
            func.apply(element, arguments);
        };
    }
};
addEvent(form_to_submit, 'submit', validate_form);
for (var i = 0; i < allInputs.length; i++) {
    var input = allInputs[i];
    addEvent(input, 'blur', function() {
        if (needs_validate(this)) {
            validate_field(this, true);
        }
    });
    addEvent(input, 'input', function() {
        if (needs_validate(this)) {
            validate_field(this);
        }
    });
};
</script>
